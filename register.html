
<!DOCTYPE html>
<html lang="zh-TW">
<head>
	<meta charset="UTF-8">
	<title>會員註冊</title>
	<script src="https://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
	<style>
		input {
		width: 300px;
		font-size: 15px;
		margin: 2px 0;
		padding: 2px 5px;
		}

		td {
		border: 1px solid #aaa;
		padding:2px 5px;
		}
	</style>
</head>

<body>
	姓名: <input id="parameter1"><br/> 
	暱稱: <input id="parameter2"><br/>
	手機: <input id="parameter3"><br/>
  
	<button id="sendBtn">註冊</button><br/>
	
	<script>
		var type = $('#type'),
			sendBtn = $('#sendBtn'),
			show = $('#show');
		var parameter = {};
		
		sendBtn.on('click', function() {
			let data = [];
			liff.getProfile().then(function (profile) {
				data = [[profile.userId, profile.displayName, $('#parameter1').val(), $('#parameter2').val(), $('#parameter3').val()]];
				//alert("data: " + JSON.stringify(data));
				parameter = {
					url: "https://docs.google.com/spreadsheets/d/1L0JDjocOddl2LaRCEwi5MnqN6q-XCflOcl8UYR-kims/edit#gid=0",
					name: "會員註冊",
					data: data.toString(),
					row: data.length,
					column: data[0].length,
					insertType: "bottom"
				};
				$.post("https://script.google.com/macros/s/AKfycbwsGWXKGHnV-qclDuYqJxeyHrJluU0U0_zlcsHQxDeqmDAnLlE/exec", parameter);
			}).catch(function (error) {
				window.alert("Error getting profile: " + error);
			});	
			                
			/* 完成會員註冊並傳送訊息 */			
			liff.sendMessages([
			{
				type: 'text',
				text: '會員資訊已送出'
			}
			]).then(() => {
				alert('done');
			})
			
			/* 完成會員註冊, 關閉視窗 */
			liff.closeWindow();
		});
	</script>	
</body>
</html>
