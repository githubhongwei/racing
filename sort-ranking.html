<!DOCTYPE html>
<html lang="zh-TW">
<head>
	<meta name="viewport" content="user-scalable=0">
	<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js'></script>
	<style>
	.title {
		font-size: 65px;
		text-align:center;
		font-family: Arial, "文泉驛正黑", "WenQuanYi Zen Hei", "儷黑 Pro", "LiHei Pro", "微軟正黑體", "Microsoft JhengHei", sans-serif;
	}
	.table {
		font-size: 50px;
		text-align:center;
		font-family: Arial, "文泉驛正黑", "WenQuanYi Zen Hei", "儷黑 Pro", "LiHei Pro", "微軟正黑體", "Microsoft JhengHei", sans-serif;
	}
	</style>
</head>
<body onload="start()">
	<div class="title">城中実業団</div>
	<div class="title">五千公尺挑戰賽排行榜</div>
	<hr>
	<div id="showTable" class ="table">Loading...</div>
	<hr>
	
	<script>
	function start() {
		LoadPages();
	}
	
	function LoadPages() {
		var gSpreadsheetsLink = "https://spreadsheets.google.com/feeds/list/1L0JDjocOddl2LaRCEwi5MnqN6q-XCflOcl8UYR-kims/";
		var gSpreadsheetsName = "onhmc4d/public/values?alt=json-in-script&callback=?"
		var gSpreadsheetsQuery = "&sq=場次>1&orderby=column:成績&reverse=false";
	
		$.getJSON(gSpreadsheetsLink + gSpreadsheetsName + gSpreadsheetsQuery, function(json){
			var vTable = "";
			vTable = vTable + "<table border=1 width=95% align=center>";
			vTable = vTable + "<tr>";
			vTable = vTable + "<td>";
			vTable = vTable + "總排名";
			vTable = vTable + "</td>";
			vTable = vTable + "<td>";
			vTable = vTable + "姓名";
			vTable = vTable + "</td>";
			vTable = vTable + "<td>";
			vTable = vTable + "最佳成績";
			vTable = vTable + "</td>";
			vTable = vTable + "<td>";
			vTable = vTable + "參加場次";
			vTable = vTable + "</td>";
			vTable = vTable + "</tr>";
			
			var e = json.feed.entry,
			entry, i, 排名, 姓名, 成績, 場次;
			gLength = e.length;

			for (i = 0; i < gLength; i++) {
				entry = e[i];
				總排名 = i + 1;
				姓名 = entry.gsx$姓名.$t;
				成績 = entry.gsx$成績.$t;
				場次 = entry.gsx$場次.$t;
				
				/* 總排名 */
				vTable = vTable + "<td>";
				vTable = vTable + 總排名;
				vTable = vTable + "</td>";
				/* 姓名 */
				vTable = vTable + "<td>";
				vTable = vTable + 姓名;
				vTable = vTable + "</td>";
				/* 成績 */
				vTable = vTable + "<td>";
				vTable = vTable + 成績;
				vTable = vTable + "</td>";
				/* 場次 */
				vTable = vTable + "<td>";
				vTable = vTable + 場次;
				vTable = vTable + "</td>";
				
				vTable = vTable + "</tr>";
				
				var vDiv = document.all("showTable").innerHTML = vTable;
			}
		});
	}
	
	</script>

</body>
</html>